{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\"use strict\";\n\nconst ImportDependency = require(\"./ImportDependency\");\n\nconst ImportEagerDependency = require(\"./ImportEagerDependency\");\n\nconst ImportWeakDependency = require(\"./ImportWeakDependency\");\n\nconst ImportContextDependency = require(\"./ImportContextDependency\");\n\nconst ImportParserPlugin = require(\"./ImportParserPlugin\");\n\nclass ImportPlugin {\n  constructor(options) {\n    this.options = options;\n  }\n\n  apply(compiler) {\n    const options = this.options;\n    compiler.hooks.compilation.tap(\"ImportPlugin\", (compilation, {\n      contextModuleFactory,\n      normalModuleFactory\n    }) => {\n      compilation.dependencyFactories.set(ImportDependency, normalModuleFactory);\n      compilation.dependencyTemplates.set(ImportDependency, new ImportDependency.Template());\n      compilation.dependencyFactories.set(ImportEagerDependency, normalModuleFactory);\n      compilation.dependencyTemplates.set(ImportEagerDependency, new ImportEagerDependency.Template());\n      compilation.dependencyFactories.set(ImportWeakDependency, normalModuleFactory);\n      compilation.dependencyTemplates.set(ImportWeakDependency, new ImportWeakDependency.Template());\n      compilation.dependencyFactories.set(ImportContextDependency, contextModuleFactory);\n      compilation.dependencyTemplates.set(ImportContextDependency, new ImportContextDependency.Template());\n\n      const handler = (parser, parserOptions) => {\n        if (parserOptions.import !== undefined && !parserOptions.import) return;\n        new ImportParserPlugin(options).apply(parser);\n      };\n\n      normalModuleFactory.hooks.parser.for(\"javascript/auto\").tap(\"ImportPlugin\", handler);\n      normalModuleFactory.hooks.parser.for(\"javascript/dynamic\").tap(\"ImportPlugin\", handler);\n      normalModuleFactory.hooks.parser.for(\"javascript/esm\").tap(\"ImportPlugin\", handler);\n    });\n  }\n\n}\n\nmodule.exports = ImportPlugin;","map":null,"metadata":{},"sourceType":"script"}