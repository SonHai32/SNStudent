{"ast":null,"code":"var _jsxFileName = \"/home/hari/Desktop/web-dev/React/cstudy/src/components/NewsFeeds/NewsFeeds.js\";\nimport React from 'react';\nimport { Segment, Header, Icon, Label, Feed, Image, Divider, Grid, Form, TextArea, Menu, Button, List, Responsive } from 'semantic-ui-react';\nimport uuid from 'uuidv4';\nimport firebase from '../../firebase';\nimport FileModal from './FileModal';\nimport moment from 'moment';\n\nclass NewsFeeds extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      like: false,\n      user: this.props.currentUser,\n      post: '',\n      fileModal: false,\n      uploadTask: null,\n      uploadStatus: '',\n      percentUploaded: 0,\n      imagePost: [],\n      postCreate: [],\n      postFromDatabase: [],\n      storeRef: firebase.storage().ref(),\n      databaseRef: firebase.database().ref('posts')\n    };\n\n    this.addPostListener = () => {\n      const ref = firebase.database().ref('posts');\n      const postLoaded = [];\n      ref.on('child_added', snap => {\n        ref.child(snap.key).on('child_added', snap => postLoaded.push(snap.toJSON()));\n        this.setState({\n          postFromDatabase: postLoaded\n        });\n      });\n    };\n\n    this.handleLikeClicked = event => {\n      event.preventDefault();\n      this.setState({\n        like: !this.state.like\n      });\n    };\n\n    this.handlePostChange = (e, {\n      value\n    }) => {\n      this.setState({\n        post: value\n      });\n    };\n\n    this.openModal = () => {\n      this.setState({\n        fileModal: true\n      });\n    };\n\n    this.closeModal = () => {\n      this.setState({\n        fileModal: false\n      });\n    };\n\n    this.uploadFile = (file, metadata) => {\n      const filePath = this.state.user.uid + '/temporaryMedia/image/' + uuid() + '.jpg';\n      this.setState({\n        uploadStatus: 'uploading',\n        uploadTask: this.state.storeRef.child(filePath).put(file, metadata)\n      }, () => {\n        this.state.uploadTask.on('state_changed', snap => {\n          const percentUploaded = Math.round(snap.bytesTransferred / snap.totalBytes * 100);\n          this.setState({\n            percentUploaded\n          });\n          console.log(this.state.percentUploaded);\n          this.state.uploadTask.snapshot.ref.getDownloadURL().then(downloadURL => {\n            this.setState({\n              imagePost: this.state.imagePost.concat({\n                downloadURL: downloadURL,\n                imagePath: this.state.uploadTask.location_.path\n              })\n            });\n          }).catch(err => console.log(err));\n          setTimeout(() => {\n            this.state.imagePost.forEach(imagePost => {\n              if (imagePost.length > 0) {\n                this.deleteImageFromStorge(imagePost.imagePath);\n              }\n            });\n            this.setState({\n              imagePost: []\n            });\n          }, 1200000); // if user doesn't post this will be delete in 20 minutesetTimeout(()=>{this.state.imagePost.forEach(imagePost => this.deleteImageFromStorge(imagePost.imagePath)) ;this.setState({imagePost: []})},5000) // if user doesn't post this will be delete in 20 minute\n        });\n      });\n    };\n\n    this.savePost = event => {\n      event.preventDefault();\n      const postCreate = {\n        createByUid: this.state.user.uid,\n        createByName: this.state.user.displayName,\n        avatar: this.state.user.photoURL,\n        timestamp: Date.now(),\n        postImages: this.state.imagePost,\n        postText: this.state.post\n      };\n      const postChild = this.state.user.uid + uuid() + '/post';\n      this.state.databaseRef.child(postChild).set(postCreate).then(() => this.setState({\n        post: '',\n        imagePost: []\n      }));\n    };\n\n    this.displayImagePost = ({\n      imagePost\n    }) => imagePost.length > 0 ? React.createElement(Segment, {\n      size: \"large\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }, React.createElement(List, {\n      horizontal: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    }, imagePost.map((val, key) => React.createElement(List.Item, {\n      key: key,\n      style: {\n        marginRight: '15px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105\n      },\n      __self: this\n    }, React.createElement(Image, {\n      rounded: true,\n      size: \"small\",\n      key: val.downloadURL,\n      src: val.downloadURL,\n      label: {\n        as: 'a',\n        name: key,\n        corner: 'right',\n        icon: 'remove',\n        size: 'mini',\n        color: 'red',\n        onClick: this.removeImagePost\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }))), React.createElement(List.Item, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      style: {\n        cursor: 'pointer',\n        boder: 'solid 2px '\n      },\n      color: \"black\",\n      inverted: true,\n      name: \"add\",\n      size: \"big\",\n      onClick: this.openModal,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    })))) : '';\n\n    this.deleteImageFromStorge = imagePath => {\n      if (imagePath) {\n        this.state.storeRef.child(imagePath).delete().then(() => console.log(\"deleted\")).catch(err => console.log(err));\n      }\n    };\n\n    this.removeImagePost = event => {\n      event.preventDefault();\n      let removeIndex = event.target.name;\n      this.deleteImageFromStorge(this.state.imagePost[removeIndex].imagePath);\n      const newImagePost = this.state.imagePost.filter((value, index, arr) => {\n        return index != removeIndex;\n      });\n      this.setState({\n        imagePost: newImagePost\n      });\n    };\n  }\n\n  componentDidMount() {\n    this.addPostListener();\n  }\n\n  render() {\n    const _this$state = this.state,\n          user = _this$state.user,\n          post = _this$state.post,\n          postFromDatabase = _this$state.postFromDatabase;\n    return React.createElement(React.Fragment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146\n      },\n      __self: this\n    }, console.log(postFromDatabase.length), React.createElement(FileModal, {\n      fileModal: this.state.fileModal,\n      uploadFile: this.uploadFile,\n      closeModal: this.closeModal,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    }), React.createElement(Segment, {\n      stacked: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    }, React.createElement(Header, {\n      as: \"h3\",\n      block: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154\n      },\n      __self: this\n    }, React.createElement(Header.Content, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    }, \"Create Post \", React.createElement(Icon, {\n      name: \"edit outline\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    }))), this.displayImagePost(this.state), React.createElement(Form, {\n      style: {\n        marginTop: '5px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165\n      },\n      __self: this\n    }, React.createElement(Form.Group, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166\n      },\n      __self: this\n    }, React.createElement(Image, {\n      avatar: true,\n      src: user.photoURL,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167\n      },\n      __self: this\n    }), React.createElement(TextArea, {\n      placeholder: \"What do you thing ? \",\n      value: post,\n      onChange: this.handlePostChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }))), React.createElement(Responsive, {\n      minWidth: 1800,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }, React.createElement(Button.Group, {\n      fluid: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176\n      },\n      __self: this\n    }, React.createElement(Button, {\n      circular: true,\n      onClick: this.openModal,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      name: \"photo\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    }), \" Photo/Video\"), React.createElement(Button, {\n      circular: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      name: \"user plus\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }), \" Tag Friends\"), React.createElement(Button, {\n      circular: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      name: \"music\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186\n      },\n      __self: this\n    }), \" Music\"), React.createElement(Button, {\n      circular: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      name: \"smile outline\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }), \" Feeling\"), React.createElement(Button, {\n      circular: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      name: \"location arrow\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192\n      },\n      __self: this\n    }), \" Check in\"), React.createElement(Button, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      name: \"list\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195\n      },\n      __self: this\n    }), \" More\"))), React.createElement(Responsive, {\n      maxWidth: 1790,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199\n      },\n      __self: this\n    }, React.createElement(Button.Group, {\n      fluid: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200\n      },\n      __self: this\n    }, React.createElement(Button, {\n      circular: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      name: \"photo\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202\n      },\n      __self: this\n    }), \" Photo/Video\"), React.createElement(Button, {\n      circular: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      name: \"user plus\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205\n      },\n      __self: this\n    }), \" Tag Friends\"), React.createElement(Button, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      name: \"list\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210\n      },\n      __self: this\n    }), \" More\"))), this.state.post.length > 0 || this.state.imagePost.length > 0 ? React.createElement(Button, {\n      onClick: this.savePost,\n      fluid: true,\n      style: {\n        marginTop: '20px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214\n      },\n      __self: this\n    }, \"Post\") : ''), postFromDatabase.length > 0 ? postFromDatabase.map((value, key) => React.createElement(Segment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224\n      },\n      __self: this\n    }, React.createElement(Feed, {\n      size: \"large\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225\n      },\n      __self: this\n    }, React.createElement(Feed.Event, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227\n      },\n      __self: this\n    }, React.createElement(Feed.Label, {\n      image: value.avatar,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228\n      },\n      __self: this\n    }), React.createElement(Feed.Content, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229\n      },\n      __self: this\n    }, React.createElement(Feed.Summary, {\n      user: value.createByName,\n      date: moment(value.timestamp).fromNow(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230\n      },\n      __self: this\n    }), React.createElement(Feed.Extra, {\n      text: true,\n      content: value.postText,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231\n      },\n      __self: this\n    })))))) : '');\n  }\n\n}\n\nexport default NewsFeeds;","map":{"version":3,"sources":["/home/hari/Desktop/web-dev/React/cstudy/src/components/NewsFeeds/NewsFeeds.js"],"names":["React","Segment","Header","Icon","Label","Feed","Image","Divider","Grid","Form","TextArea","Menu","Button","List","Responsive","uuid","firebase","FileModal","moment","NewsFeeds","Component","state","like","user","props","currentUser","post","fileModal","uploadTask","uploadStatus","percentUploaded","imagePost","postCreate","postFromDatabase","storeRef","storage","ref","databaseRef","database","addPostListener","postLoaded","on","snap","child","key","push","toJSON","setState","handleLikeClicked","event","preventDefault","handlePostChange","e","value","openModal","closeModal","uploadFile","file","metadata","filePath","uid","put","Math","round","bytesTransferred","totalBytes","console","log","snapshot","getDownloadURL","then","downloadURL","concat","imagePath","location_","path","catch","err","setTimeout","forEach","length","deleteImageFromStorge","savePost","createByUid","createByName","displayName","avatar","photoURL","timestamp","Date","now","postImages","postText","postChild","set","displayImagePost","map","val","marginRight","as","name","corner","icon","size","color","onClick","removeImagePost","cursor","boder","delete","removeIndex","target","newImagePost","filter","index","arr","componentDidMount","render","marginTop","fromNow"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAAQC,OAAR,EAAgBC,MAAhB,EAAuBC,IAAvB,EAA4BC,KAA5B,EAAmCC,IAAnC,EAAwCC,KAAxC,EAA+CC,OAA/C,EAAwDC,IAAxD,EAA8DC,IAA9D,EAAoEC,QAApE,EAA8EC,IAA9E,EAAoFC,MAApF,EAA4FC,IAA5F,EAAkGC,UAAlG,QAAmH,mBAAnH;AACA,OAAOC,IAAP,MAAiB,QAAjB;AACA,OAAOC,QAAP,MAAqB,gBAArB;AACA,OAAOC,SAAP,MAAsB,aAAtB;AACA,OAAOC,MAAP,MAAmB,QAAnB;;AACA,MAAMC,SAAN,SAAwBnB,KAAK,CAACoB,SAA9B,CAAuC;AAAA;AAAA;AAAA,SAEnCC,KAFmC,GAE5B;AACLC,MAAAA,IAAI,EAAE,KADD;AAELC,MAAAA,IAAI,EAAE,KAAKC,KAAL,CAAWC,WAFZ;AAGLC,MAAAA,IAAI,EAAE,EAHD;AAILC,MAAAA,SAAS,EAAE,KAJN;AAKLC,MAAAA,UAAU,EAAE,IALP;AAMLC,MAAAA,YAAY,EAAG,EANV;AAOLC,MAAAA,eAAe,EAAG,CAPb;AAQLC,MAAAA,SAAS,EAAE,EARN;AASLC,MAAAA,UAAU,EAAE,EATP;AAULC,MAAAA,gBAAgB,EAAE,EAVb;AAWLC,MAAAA,QAAQ,EAAElB,QAAQ,CAACmB,OAAT,GAAmBC,GAAnB,EAXL;AAYLC,MAAAA,WAAW,EAAErB,QAAQ,CAACsB,QAAT,GAAoBF,GAApB,CAAwB,OAAxB;AAZR,KAF4B;;AAAA,SAsBnCG,eAtBmC,GAsBjB,MAAK;AAErB,YAAMH,GAAG,GAAGpB,QAAQ,CAACsB,QAAT,GAAoBF,GAApB,CAAwB,OAAxB,CAAZ;AACA,YAAMI,UAAU,GAAG,EAAnB;AACAJ,MAAAA,GAAG,CAACK,EAAJ,CAAO,aAAP,EAAqBC,IAAI,IAAG;AAC1BN,QAAAA,GAAG,CAACO,KAAJ,CAAUD,IAAI,CAACE,GAAf,EAAoBH,EAApB,CAAuB,aAAvB,EAAqCC,IAAI,IAAIF,UAAU,CAACK,IAAX,CAAgBH,IAAI,CAACI,MAAL,EAAhB,CAA7C;AACA,aAAKC,QAAL,CAAc;AAACd,UAAAA,gBAAgB,EAAEO;AAAnB,SAAd;AAED,OAJD;AAMD,KAhCkC;;AAAA,SAmCnCQ,iBAnCmC,GAmCfC,KAAK,IAAG;AACxBA,MAAAA,KAAK,CAACC,cAAN;AACA,WAAKH,QAAL,CAAc;AAACzB,QAAAA,IAAI,EAAE,CAAC,KAAKD,KAAL,CAAWC;AAAnB,OAAd;AACH,KAtCkC;;AAAA,SAwCnC6B,gBAxCmC,GAwChB,CAACC,CAAD,EAAI;AAAEC,MAAAA;AAAF,KAAJ,KAAgB;AACjC,WAAKN,QAAL,CAAc;AAACrB,QAAAA,IAAI,EAAE2B;AAAP,OAAd;AACD,KA1CkC;;AAAA,SA4CnCC,SA5CmC,GA4CvB,MAAK;AACf,WAAKP,QAAL,CAAc;AAACpB,QAAAA,SAAS,EAAE;AAAZ,OAAd;AACD,KA9CkC;;AAAA,SAgDnC4B,UAhDmC,GAgDtB,MAAK;AAEhB,WAAKR,QAAL,CAAc;AAACpB,QAAAA,SAAS,EAAE;AAAZ,OAAd;AACD,KAnDkC;;AAAA,SAqDnC6B,UArDmC,GAqDtB,CAACC,IAAD,EAAOC,QAAP,KAAmB;AAC9B,YAAMC,QAAQ,GAAG,KAAKtC,KAAL,CAAWE,IAAX,CAAgBqC,GAAhB,GAAoB,wBAApB,GAA6C7C,IAAI,EAAjD,GAAoD,MAArE;AAEA,WAAKgC,QAAL,CAAc;AACZlB,QAAAA,YAAY,EAAG,WADH;AAEZD,QAAAA,UAAU,EAAE,KAAKP,KAAL,CAAWa,QAAX,CAAoBS,KAApB,CAA0BgB,QAA1B,EAAoCE,GAApC,CAAwCJ,IAAxC,EAA6CC,QAA7C;AAFA,OAAd,EAKI,MAAM;AACJ,aAAKrC,KAAL,CAAWO,UAAX,CAAsBa,EAAtB,CAAyB,eAAzB,EAA0CC,IAAI,IAAG;AAC/C,gBAAMZ,eAAe,GAAGgC,IAAI,CAACC,KAAL,CAAYrB,IAAI,CAACsB,gBAAL,GAAwBtB,IAAI,CAACuB,UAA9B,GAA0C,GAArD,CAAxB;AACA,eAAKlB,QAAL,CAAc;AAACjB,YAAAA;AAAD,WAAd;AACAoC,UAAAA,OAAO,CAACC,GAAR,CAAY,KAAK9C,KAAL,CAAWS,eAAvB;AAEF,eAAKT,KAAL,CAAWO,UAAX,CAAsBwC,QAAtB,CAA+BhC,GAA/B,CAAmCiC,cAAnC,GAAoDC,IAApD,CAAyDC,WAAW,IAAI;AAAC,iBAAKxB,QAAL,CAAc;AAAChB,cAAAA,SAAS,EAAE,KAAKV,KAAL,CAAWU,SAAX,CAAqByC,MAArB,CAA4B;AAACD,gBAAAA,WAAW,EAAEA,WAAd;AAA0BE,gBAAAA,SAAS,EAAE,KAAKpD,KAAL,CAAWO,UAAX,CAAsB8C,SAAtB,CAAgCC;AAArE,eAA5B;AAAZ,aAAd;AAAsI,WAA/M,EAAiNC,KAAjN,CAAuNC,GAAG,IAAEX,OAAO,CAACC,GAAR,CAAYU,GAAZ,CAA5N;AACAC,UAAAA,UAAU,CAAC,MAAI;AAAC,iBAAKzD,KAAL,CAAWU,SAAX,CAAqBgD,OAArB,CAA6BhD,SAAS,IAAI;AAAC,kBAAGA,SAAS,CAACiD,MAAV,GAAmB,CAAtB,EAA0B;AAAC,qBAAKC,qBAAL,CAA2BlD,SAAS,CAAC0C,SAArC;AAAgD;AAAC,aAAvH;AAA0H,iBAAK1B,QAAL,CAAc;AAAChB,cAAAA,SAAS,EAAE;AAAZ,aAAd;AAA+B,WAA/J,EAAgK,OAAhK,CAAV,CANiD,CAMkI;AAClL,SAPD;AAQD,OAdL;AAgBC,KAxEgC;;AAAA,SA0EjCmD,QA1EiC,GA0EtBjC,KAAK,IAAG;AACjBA,MAAAA,KAAK,CAACC,cAAN;AACA,YAAMlB,UAAU,GAAE;AAChBmD,QAAAA,WAAW,EAAE,KAAK9D,KAAL,CAAWE,IAAX,CAAgBqC,GADb;AAEhBwB,QAAAA,YAAY,EAAE,KAAK/D,KAAL,CAAWE,IAAX,CAAgB8D,WAFd;AAGhBC,QAAAA,MAAM,EAAE,KAAKjE,KAAL,CAAWE,IAAX,CAAgBgE,QAHR;AAIhBC,QAAAA,SAAS,EAAEC,IAAI,CAACC,GAAL,EAJK;AAKhBC,QAAAA,UAAU,EAAE,KAAKtE,KAAL,CAAWU,SALP;AAMhB6D,QAAAA,QAAQ,EAAE,KAAKvE,KAAL,CAAWK;AANL,OAAlB;AASA,YAAMmE,SAAS,GAAG,KAAKxE,KAAL,CAAWE,IAAX,CAAgBqC,GAAhB,GAAoB7C,IAAI,EAAxB,GAA2B,OAA7C;AAEA,WAAKM,KAAL,CAAWgB,WAAX,CAAuBM,KAAvB,CAA6BkD,SAA7B,EAAwCC,GAAxC,CAA4C9D,UAA5C,EAAwDsC,IAAxD,CAA6D,MAAI,KAAKvB,QAAL,CAAc;AAACrB,QAAAA,IAAI,EAAE,EAAP;AAAWK,QAAAA,SAAS,EAAE;AAAtB,OAAd,CAAjE;AAGD,KA1FgC;;AAAA,SA4FjCgE,gBA5FiC,GA4Fd,CAAC;AAAChE,MAAAA;AAAD,KAAD,KACjBA,SAAS,CAACiD,MAAV,GAAmB,CAAnB,GACA,oBAAC,OAAD;AAAS,MAAA,IAAI,EAAC,OAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,IAAD;AAAO,MAAA,UAAU,MAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAEKjD,SAAS,CAACiE,GAAV,CAAc,CAACC,GAAD,EAAKrD,GAAL,KACb,oBAAC,IAAD,CAAM,IAAN;AAAW,MAAA,GAAG,EAAEA,GAAhB;AAAqB,MAAA,KAAK,EAAE;AAACsD,QAAAA,WAAW,EAAE;AAAd,OAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,KAAD;AAAO,MAAA,OAAO,MAAd;AAAe,MAAA,IAAI,EAAC,OAApB;AAA4B,MAAA,GAAG,EAAED,GAAG,CAAC1B,WAArC;AAAkD,MAAA,GAAG,EAAE0B,GAAG,CAAC1B,WAA3D;AAAwE,MAAA,KAAK,EAAE;AAAC4B,QAAAA,EAAE,EAAE,GAAL;AAAUC,QAAAA,IAAI,EAAExD,GAAhB;AAAqByD,QAAAA,MAAM,EAAC,OAA5B;AAAqCC,QAAAA,IAAI,EAAC,QAA1C;AAAmDC,QAAAA,IAAI,EAAE,MAAzD;AAAgEC,QAAAA,KAAK,EAAC,KAAtE;AAA4EC,QAAAA,OAAO,EAAE,KAAKC;AAA1F,OAA/E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CADD,CAFL,EAOE,oBAAC,IAAD,CAAM,IAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,IAAD;AAAM,MAAA,KAAK,EAAE;AAACC,QAAAA,MAAM,EAAE,SAAT;AAAoBC,QAAAA,KAAK,EAAE;AAA3B,OAAb;AAAuD,MAAA,KAAK,EAAC,OAA7D;AAAqE,MAAA,QAAQ,MAA7E;AAA8E,MAAA,IAAI,EAAC,KAAnF;AAAyF,MAAA,IAAI,EAAC,KAA9F;AAAoG,MAAA,OAAO,EAAE,KAAKtD,SAAlH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CAPF,CADF,CADA,GAca,EA3GkB;;AAAA,SA8GjC2B,qBA9GiC,GA8GTR,SAAS,IAAG;AAChC,UAAGA,SAAH,EAAa;AACX,aAAKpD,KAAL,CAAWa,QAAX,CAAoBS,KAApB,CAA0B8B,SAA1B,EAAqCoC,MAArC,GAA8CvC,IAA9C,CAAmD,MAAMJ,OAAO,CAACC,GAAR,CAAY,SAAZ,CAAzD,EAAiFS,KAAjF,CAAuFC,GAAG,IAAGX,OAAO,CAACC,GAAR,CAAYU,GAAZ,CAA7F;AACD;AAEJ,KAnHgC;;AAAA,SAqHjC6B,eArHiC,GAqHfzD,KAAK,IAAG;AACxBA,MAAAA,KAAK,CAACC,cAAN;AACA,UAAI4D,WAAW,GAAG7D,KAAK,CAAC8D,MAAN,CAAaX,IAA/B;AAEA,WAAKnB,qBAAL,CAA2B,KAAK5D,KAAL,CAAWU,SAAX,CAAqB+E,WAArB,EAAkCrC,SAA7D;AAEA,YAAMuC,YAAY,GAAG,KAAK3F,KAAL,CAAWU,SAAX,CAAqBkF,MAArB,CAA4B,CAAC5D,KAAD,EAAO6D,KAAP,EAAaC,GAAb,KAAoB;AACnE,eAAOD,KAAK,IAAIJ,WAAhB;AACD,OAFoB,CAArB;AAKA,WAAK/D,QAAL,CAAc;AAAChB,QAAAA,SAAS,EAAGiF;AAAb,OAAd;AAGD,KAnIgC;AAAA;;AAkBnCI,EAAAA,iBAAiB,GAAE;AACjB,SAAK7E,eAAL;AACD;;AAmHD8E,EAAAA,MAAM,GAAE;AAAA,wBACiC,KAAKhG,KADtC;AAAA,UACGE,IADH,eACGA,IADH;AAAA,UACQG,IADR,eACQA,IADR;AAAA,UACaO,gBADb,eACaA,gBADb;AAGJ,WACF,oBAAC,KAAD,CAAO,QAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGiC,OAAO,CAACC,GAAR,CAAYlC,gBAAgB,CAAC+C,MAA7B,CADH,EAEE,oBAAC,SAAD;AAAW,MAAA,SAAS,EAAE,KAAK3D,KAAL,CAAWM,SAAjC;AACW,MAAA,UAAU,EAAI,KAAK6B,UAD9B;AAEW,MAAA,UAAU,EAAI,KAAKD,UAF9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,EAMF,oBAAC,OAAD;AAAS,MAAA,OAAO,MAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAEI,oBAAC,MAAD;AAAQ,MAAA,EAAE,EAAC,IAAX;AAAgB,MAAA,KAAK,MAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAEE,oBAAC,MAAD,CAAQ,OAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAA4B,oBAAC,IAAD;AAAM,MAAA,IAAI,EAAC,cAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAA5B,CAFF,CAFJ,EAQO,KAAKwC,gBAAL,CAAsB,KAAK1E,KAA3B,CARP,EAaI,oBAAC,IAAD;AAAM,MAAA,KAAK,EAAE;AAACiG,QAAAA,SAAS,EAAE;AAAZ,OAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACC,oBAAC,IAAD,CAAM,KAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,KAAD;AAAO,MAAA,MAAM,MAAb;AAAc,MAAA,GAAG,EAAE/F,IAAI,CAACgE,QAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,EAEE,oBAAC,QAAD;AAAU,MAAA,WAAW,EAAC,sBAAtB;AAA6C,MAAA,KAAK,EAAE7D,IAApD;AAA0D,MAAA,QAAQ,EAAE,KAAKyB,gBAAzE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,CADD,CAbJ,EAuBE,oBAAC,UAAD;AAAY,MAAA,QAAQ,EAAE,IAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACA,oBAAC,MAAD,CAAQ,KAAR;AAAc,MAAA,KAAK,MAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAEA,oBAAC,MAAD;AAAQ,MAAA,QAAQ,MAAhB;AAAiB,MAAA,OAAO,EAAE,KAAKG,SAA/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACQ,oBAAC,IAAD;AAAM,MAAA,IAAI,EAAC,OAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADR,iBAFA,EAKM,oBAAC,MAAD;AAAQ,MAAA,QAAQ,MAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,IAAD;AAAM,MAAA,IAAI,EAAC,WAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,iBALN,EASM,oBAAC,MAAD;AAAQ,MAAA,QAAQ,MAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,IAAD;AAAM,MAAA,IAAI,EAAC,OAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,WATN,EAYM,oBAAC,MAAD;AAAQ,MAAA,QAAQ,MAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,IAAD;AAAM,MAAA,IAAI,EAAC,eAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,aAZN,EAeM,oBAAC,MAAD;AAAQ,MAAA,QAAQ,MAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,IAAD;AAAM,MAAA,IAAI,EAAC,gBAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,cAfN,EAkBM,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,IAAD;AAAM,MAAA,IAAI,EAAC,MAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,UAlBN,CADA,CAvBF,EA+CE,oBAAC,UAAD;AAAY,MAAA,QAAQ,EAAE,IAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACA,oBAAC,MAAD,CAAQ,KAAR;AAAc,MAAA,KAAK,MAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACA,oBAAC,MAAD;AAAQ,MAAA,QAAQ,MAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACQ,oBAAC,IAAD;AAAM,MAAA,IAAI,EAAC,OAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADR,iBADA,EAIM,oBAAC,MAAD;AAAQ,MAAA,QAAQ,MAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,IAAD;AAAM,MAAA,IAAI,EAAC,WAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,iBAJN,EASM,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,IAAD;AAAM,MAAA,IAAI,EAAC,MAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,UATN,CADA,CA/CF,EA8DG,KAAKjC,KAAL,CAAWK,IAAX,CAAgBsD,MAAhB,GAAyB,CAAzB,IAA8B,KAAK3D,KAAL,CAAWU,SAAX,CAAqBiD,MAArB,GAA6B,CAA3D,GAA+D,oBAAC,MAAD;AAAS,MAAA,OAAO,EAAE,KAAKE,QAAvB;AAAiC,MAAA,KAAK,MAAtC;AAAuC,MAAA,KAAK,EAAE;AAACoC,QAAAA,SAAS,EAAE;AAAZ,OAA9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAA/D,GAEW,EAhEd,CANE,EA4ECrF,gBAAgB,CAAC+C,MAAjB,GAA0B,CAA1B,GACC/C,gBAAgB,CAAC+D,GAAjB,CAAqB,CAAC3C,KAAD,EAAQT,GAAR,KACnB,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACA,oBAAC,IAAD;AAAM,MAAA,IAAI,EAAC,OAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAEA,oBAAC,IAAD,CAAM,KAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,IAAD,CAAM,KAAN;AAAY,MAAA,KAAK,EAAES,KAAK,CAACiC,MAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,EAEE,oBAAC,IAAD,CAAM,OAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,IAAD,CAAM,OAAN;AAAc,MAAA,IAAI,EAAEjC,KAAK,CAAC+B,YAA1B;AAAwC,MAAA,IAAI,EAAElE,MAAM,CAACmC,KAAK,CAACmC,SAAP,CAAN,CAAwB+B,OAAxB,EAA9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,EAEE,oBAAC,IAAD,CAAM,KAAN;AAAY,MAAA,IAAI,MAAhB;AAAiB,MAAA,OAAO,EAAElE,KAAK,CAACuC,QAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,CAFF,CAFA,CADA,CADF,CADD,GAgBI,EA5FL,CADE;AAmKH;;AA7SkC;;AAiTvC,eAAezE,SAAf","sourcesContent":["import React from 'react'\nimport {Segment,Header,Icon,Label, Feed,Image, Divider, Grid, Form, TextArea, Menu, Button, List, Responsive} from 'semantic-ui-react'\nimport uuid from 'uuidv4'\nimport firebase from '../../firebase'\nimport FileModal from './FileModal'\nimport moment from 'moment'\nclass NewsFeeds extends React.Component{\n\n    state ={\n      like: false,\n      user: this.props.currentUser,\n      post: '',\n      fileModal: false,\n      uploadTask: null,\n      uploadStatus : '',\n      percentUploaded : 0,\n      imagePost: [],\n      postCreate: [],\n      postFromDatabase: [],\n      storeRef: firebase.storage().ref(),\n      databaseRef: firebase.database().ref('posts')\n     \n    }\n\n    componentDidMount(){\n      this.addPostListener()\n    }\n\n    addPostListener = () =>{\n\n      const ref = firebase.database().ref('posts')\n      const postLoaded = []\n      ref.on('child_added',snap =>{\n        ref.child(snap.key).on('child_added',snap => postLoaded.push(snap.toJSON()));\n        this.setState({postFromDatabase: postLoaded})\n        \n      })\n  \n    }\n\n\n    handleLikeClicked = event =>{\n        event.preventDefault();\n        this.setState({like: !this.state.like })\n    }\n    \n    handlePostChange = (e, { value}) =>{\n      this.setState({post: value})\n    }\n    \n    openModal = () =>{\n      this.setState({fileModal: true})\n    }\n\n    closeModal = () =>{\n\n      this.setState({fileModal: false})\n    }\n\n    uploadFile = (file, metadata) =>{\n      const filePath = this.state.user.uid+'/temporaryMedia/image/'+uuid()+'.jpg'\n\n      this.setState({\n        uploadStatus : 'uploading',\n        uploadTask: this.state.storeRef.child(filePath).put(file,metadata)\n      \n        },\n          () => {\n            this.state.uploadTask.on('state_changed', snap =>{\n              const percentUploaded = Math.round((snap.bytesTransferred / snap.totalBytes)*100)\n              this.setState({percentUploaded});\n              console.log(this.state.percentUploaded);\n            \n            this.state.uploadTask.snapshot.ref.getDownloadURL().then(downloadURL => {this.setState({imagePost: this.state.imagePost.concat({downloadURL: downloadURL,imagePath: this.state.uploadTask.location_.path })}) }).catch(err=>console.log(err))\n            setTimeout(()=>{this.state.imagePost.forEach(imagePost => {if(imagePost.length > 0 ) {this.deleteImageFromStorge(imagePost.imagePath)}}) ;this.setState({imagePost: []})},1200000) // if user doesn't post this will be delete in 20 minutesetTimeout(()=>{this.state.imagePost.forEach(imagePost => this.deleteImageFromStorge(imagePost.imagePath)) ;this.setState({imagePost: []})},5000) // if user doesn't post this will be delete in 20 minute\n            })\n          }\n        )\n      }\n\n      savePost = event =>{\n        event.preventDefault();\n        const postCreate ={\n          createByUid: this.state.user.uid,\n          createByName: this.state.user.displayName,\n          avatar: this.state.user.photoURL ,\n          timestamp: Date.now(),\n          postImages: this.state.imagePost,\n          postText: this.state.post\n        }\n\n        const postChild = this.state.user.uid+uuid()+'/post';\n\n        this.state.databaseRef.child(postChild).set(postCreate).then(()=>this.setState({post: '', imagePost: []}))\n        \n\n      }\n\n      displayImagePost = ({imagePost}) =>(\n        imagePost.length > 0 ? \n        <Segment size='large' >\n          <List  horizontal>\n          \n              {imagePost.map((val,key) => (\n                <List.Item key={key} style={{marginRight: '15px'}}> \n                  <Image rounded size='small' key={val.downloadURL} src={val.downloadURL} label={{as: 'a' ,name: key, corner:'right', icon:'remove',size: 'mini',color:'red',onClick: this.removeImagePost}} /> \n                </List.Item> ) )}\n                \n            <List.Item>\n              <Icon style={{cursor: 'pointer', boder: 'solid 2px '}} color='black' inverted name='add' size='big' onClick={this.openModal} />\n            </List.Item>\n          </List>\n          \n        </Segment> : ''\n      )\n      \n      deleteImageFromStorge = imagePath =>{\n          if(imagePath){\n            this.state.storeRef.child(imagePath).delete().then(() => console.log(\"deleted\")).catch(err=> console.log(err))\n          }\n          \n      }\n\n      removeImagePost = event =>{\n        event.preventDefault();\n        let removeIndex = event.target.name;\n        \n        this.deleteImageFromStorge(this.state.imagePost[removeIndex].imagePath)\n\n        const newImagePost = this.state.imagePost.filter((value,index,arr) =>{\n          return index != removeIndex\n        })\n        \n\n        this.setState({imagePost : newImagePost})\n        \n        \n      }\n    \n\n\n    render(){\n        const {user,post,postFromDatabase} = this.state;\n       \n        return(\n      <React.Fragment>\n        {console.log(postFromDatabase.length)}\n        <FileModal fileModal={this.state.fileModal}\n                   uploadFile = {this.uploadFile}\n                   closeModal = {this.closeModal}\n        />\n    <Segment stacked>\n      \n        <Header as='h3' block>\n        \n          <Header.Content>Create Post <Icon name='edit outline' /></Header.Content>\n        \n        </Header>\n        \n          {this.displayImagePost(this.state)}\n        \n\n    \n\n        <Form style={{marginTop: '5px'}}>\n         <Form.Group >\n           <Image avatar src={user.photoURL}/>\n           <TextArea placeholder='What do you thing ? ' value={post} onChange={this.handlePostChange} >\n          \n          </TextArea>\n         </Form.Group>\n        \n        </Form>\n       \n      <Responsive minWidth={1800}>\n      <Button.Group fluid >\n        \n      <Button circular onClick={this.openModal}  >\n              <Icon name='photo' /> Photo/Video\n            </Button>\n            <Button circular>\n              <Icon name='user plus' /> Tag Friends\n            </Button>\n         \n            <Button circular>\n              <Icon name='music' /> Music\n            </Button>\n            <Button circular>\n              <Icon name='smile outline' /> Feeling\n            </Button>\n            <Button circular>\n              <Icon name='location arrow' /> Check in\n            </Button>\n            <Button>\n              <Icon name='list' /> More\n             </Button>\n      </Button.Group>\n      </Responsive>\n      <Responsive maxWidth={1790} >\n      <Button.Group fluid >\n      <Button circular  >\n              <Icon name='photo' /> Photo/Video\n            </Button>\n            <Button circular>\n              <Icon name='user plus' /> Tag Friends\n            </Button>\n         \n            \n            <Button>\n              <Icon name='list' /> More\n             </Button>\n      </Button.Group>\n      </Responsive>\n      {this.state.post.length > 0 || this.state.imagePost.length >0 ? <Button  onClick={this.savePost} fluid style={{marginTop: '20px'}}>\n        Post\n      </Button> : ''}\n         \n    </Segment>\n    \n      \n    \n      {postFromDatabase.length > 0 ? (\n        postFromDatabase.map((value, key) =>(\n          <Segment >\n          <Feed size='large'  >\n          \n          <Feed.Event>\n            <Feed.Label image={value.avatar} />\n            <Feed.Content >\n              <Feed.Summary user={value.createByName} date={moment(value.timestamp).fromNow()} />\n              <Feed.Extra text content={value.postText} />\n              \n            </Feed.Content>\n          </Feed.Event>\n      </Feed>\n      </Segment>\n        ))\n      ) :  ''}\n\n      {/* <Feed size='large'  >\n    \n    <Feed.Event   >\n      <Feed.Label>   \n        <img src='https://www.gravatar.com/avatar/b4339e6c847f4f25822532330320548e?d=identicon' />\n      </Feed.Label>\n      <Feed.Content>\n        <Feed.Summary >\n          <Feed.User>Elliot Fu</Feed.User> added you as a friend\n          <Feed.Date>1 Hour Ago</Feed.Date>\n          \n        </Feed.Summary>\n        <Feed.Extra text>\n        \n        Text messaging, or texting, is the act of composing and sending electronic messages, typically consisting of alphabetic and numeric characters, between two or more users of mobile devices, desktops/laptops, or other type of compatible computer. Text messages may be sent over a cellular network, or may also be sent via an Internet connection.\n\nThe term originally referred to messages sent using the Short Message Service (SMS). It has grown beyond alphanumeric text to include multimedia messages (known as MMS) containing digital images, videos, and sound content, as well as ideograms known as emoji (happy faces, sad faces, and other icons).\n\nText messages are used for personal, family, business and social purposes. Governmental and non-governmental organizations use text messaging for communication between colleagues. In the 2010s, the sending of short informal messages has become an accepted part of many cultures, as happened earlier with emailing.[1] This makes texting a quick and easy way to communicate with friends, family and colleagues, \nincluding in contexts where a call would be impolite or inappropriate (e.g., \ncalling very late at night or when one knows the other person is busy with family or work activities). \nLike e-mail and voicemail, and unlike calls (in which the caller hopes to speak directly with the recipient), \ntexting does not require the caller and recipient to both be free at the same moment; this permits communication even between busy individuals. \nText messages can also be used to interact with automated systems, \nAdvertisers and service providers use direct text marketing to send messages to mobile users about promotions, payment due dates, \n and other notifications instead of using postal mail, email, or voicemail.\n Advertisers and service providers use direct text marketing to send messages to mobile users about promotions, payment due dates, \n and other notifications instead of using postal mail, email, or voicemail.\n and other notifications instead of using postal mail, email, or voicemail.\n and other notifications instead of using postal mail, email, or voicemail.\n and other notifications instead of using postal mail, email, or voicemail.\n       \nfor example, to order products or services from e-commerce websites, or to participate in online contests.\n Advertisers and service providers use direct text marketing to send messages to mobile users about promotions, payment due dates, \n and other notifications instead of using postal mail, email, or voicemail.\n \n \n        </Feed.Extra>\n        <Divider clearing />\n        <Feed.Extra text >\n          20 likes\n        </Feed.Extra>\n        <Divider clearing />\n        <Feed.Meta>\n        \n          <Feed.Like   as='a' style={{marginRight: '20px'}}>\n            <Icon size='large' name='thumbs up outline' /> Like\n          </Feed.Like>\n        \n          <Feed.Like > \n            <Icon name='comment outline' size='large' /> Comment\n          </Feed.Like>\n         \n        </Feed.Meta>\n      </Feed.Content>\n    </Feed.Event>\n  \n      </Feed> */}\n      \n\n \n\n      \n  </React.Fragment>\n \n           \n            \n        )\n    }\n\n}\n\nexport default NewsFeeds"]},"metadata":{},"sourceType":"module"}